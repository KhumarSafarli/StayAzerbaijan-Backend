@model StayAzerbaijan.ViewModels.SearchResultViewModel
@{
    ViewData["Title"] = "Searchresult";
}
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous" />
    <link rel="stylesheet" href="../scss/main.css" />

    <link rel="stylesheet"
          type="text/css"
          href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />
    <script type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script defer src="../common/subscribe.js"></script>
    <script defer src="../common/burger-menu.js"></script>
    <script defer src="../common/book.js"></script>
    <script defer src="../common/trending.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
            integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
            crossorigin="anonymous"></script>
    <script defer src="../common/checkout.js"></script>
    <title>Axtarış nəticələri</title>
</head>

    <div class="results">
        <div class="header-text">
            <h1>Axtarış nəticələri </h1>
        </div>
    </div>
    <div class="main-results">
        <div class="left-bar">
        <form asp-action="SearchResult" asp-controller="Result" method="get">
            <div class="qiymet">
                <label for="price-range">Qiymət aralığı: <span id="price-label">0 AZN</span> - <span id="price-label-max">10000 AZN</span></label>
                <div class="range-container">
                    <input type="range" class="form-range" min="0" max="300" id="price-range" style="z-index:2 ;">
                    <input type="range" class="form-range" min="300" max="10000" id="price-range-max">
                </div>
            </div>

                <div class="category-box">
                    <p class="category">Kateqoriya</p>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="luxury">
                        <label class="form-check-label" for="luxury">Luxury</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="honeymoon">
                        <label class="form-check-label" for="honeymoon">Bal ayı</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="family-friendly">
                        <label class="form-check-label" for="family-friendly">Ailəvi</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="beach-front">
                        <label class="form-check-label" for="beach-front">Dəniz kənarı</label>
                    </div>
                </div>
                <div class="meal-type">
                    <p class="category">Qidalanma</p>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="BB">
                        <label class="form-check-label" for="BB">BB (səhər yeməyi)</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="HB">
                        <label class="form-check-label" for="HB">HB (gündə 2 dəfə)</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="FB">
                        <label class="form-check-label" for="FB">FB (gündə 3 dəfə)</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="RO">
                        <label class="form-check-label" for="RO">RO (yalnız otaq)</label>
                    </div>
                </div>
            </form>
        </div>
    <div class="hotel-results-container">

        @foreach (var hotel in Model.FilteredHotels)
        {var room = hotel.Rooms.First();
            <div class="hotel-container">
                <div class="left-side">
                    <img src="~/../assets/images/@hotel.MainImgUrl" />
                </div>
                <div class="right-part">
                    <div class="name-and-star">
                        <div class="first">
                            <h5 class="name">@hotel.Name</h5>
                            <div class="ratingstars">
                                @for (int i = 0; i < hotel.Star; i++)
                                {
                                    <img src="~/../assets/icons/star.svg" id="hotel-star" />
                                }
                            </div>
                        </div>
                        <div class="second">
                            <h5>@hotel.Star</h5>
                        </div>
                    </div>
                    <p class="location">Məkan: @hotel.Location</p>
                    <p class="category">Kateqoriya: @(hotel.HotelCategories != null ? string.Join(", ", hotel.HotelCategories.Where(c => c.Category != null).Select(c => c.Category.Name)) : "Uyğun kateqoriya yoxdu")</p>
                    <div class="room-price-info">
                        <div class="left">
                            <p class="room">Otaq:@room.Name</p>
                            <p class="bed-type">Yataq: @room.BedType</p>
                            <p class="meal-plan">Qidalanma: @(hotel.HotelMealTypes != null && hotel.HotelMealTypes.Any() ? string.Join(", ", hotel.HotelMealTypes.Where(mt => mt.MealType != null).Select(mt => mt.MealType.Name)) : "Qidalanma yoxdur")</p>
                            <p class="cancellation-policy">Ləğv edilmə: Bu rezervasiya ləğv edilə bilməz</p>
                        </div>
                        <div class="right">
                            <div class="nights-pax">
                                <p class="date">Check-in: @Model.CheckInDate.ToShortDateString()</p>
                                <p class="date">Check-out: @Model.CheckOutDate.ToShortDateString()</p>
                                <p class="nights">@Model.CheckOutDate.Subtract(Model.CheckInDate).Days gecə</p>
                                <p class="pax-number">@Model.AdultCount adl + @Model.ChildCount chd</p>
                            </div>
                            @{
                                int numberOfNights = (int)(Model.CheckOutDate - Model.CheckInDate).TotalDays;
                                decimal totalPrice = hotel.Rooms != null && hotel.Rooms.Any() ? hotel.Rooms.First().Price * numberOfNights : 0;

                            }
                            <p class="total-price">@totalPrice AZN</p>
                            <a href="~/Reservation/Reservation?hotelId=@hotel.Id
&roomId=@room.Id
&checkInDate=@Model.CheckInDate.ToString("yyyy-MM-dd")
&checkOutDate=@Model.CheckOutDate.ToString("yyyy-MM-dd")
&roomType=@Model.SelectedRoomType
&paxCount=@Model.AdultCount
&nights=@Model.CheckOutDate.Subtract(Model.CheckInDate).Days
&totalPrice=@totalPrice">Rezervasiya et</a>




                        </div>
                    </div>
                </div>
            </div>
        }
    </div>


    </div>
<script>
    const priceRange = document.getElementById('price-range');
    const priceRangeMax = document.getElementById('price-range-max');
    const priceLabel = document.getElementById('price-label');
    const priceLabelMax = document.getElementById('price-label-max');

    priceRange.addEventListener('input', function () {
        const price = this.value;
        priceLabel.textContent = price + ' AZN';
    });

    priceRangeMax.addEventListener('input', function () {
        const priceMax = this.value;
        priceLabelMax.textContent = priceMax + ' AZN';
    });
</script>




